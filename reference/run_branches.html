<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Evaluate a function across different local package branches — run_branches • cross</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate a function across different local package branches — run_branches"><meta property="og:description" content="run_branches() is similar to run(), except it allows you to run fn
across different local branches corresponding to the same package, rather
than different CRAN or GitHub versions of that package.
The default behavior runs the current branch against the main branch."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cross</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisVaughan/cross/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate a function across different local package branches</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisVaughan/cross/blob/HEAD/R/run.R" class="external-link"><code>R/run.R</code></a></small>
    <div class="hidden name"><code>run_branches.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>run_branches()</code> is similar to <code><a href="run.html">run()</a></code>, except it allows you to run <code>fn</code>
across different local branches corresponding to the same package, rather
than different CRAN or GitHub versions of that package.</p>
<p>The default behavior runs the current branch against the <code>main</code> branch.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_branches</span><span class="op">(</span></span>
<span>  <span class="va">fn</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  current <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  branches <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  libpath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/libPaths.html" class="external-link">.libPaths</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  args_pak <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  args_callr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fn</dt>
<dd><p><code>[function]</code></p>
<p>A function to evaluate. The function is passed along to <code><a href="https://callr.r-lib.org/reference/r.html" class="external-link">callr::r()</a></code>, so
it is evaluated in a fresh R session and must be self-contained.</p>
<p>Read the <code>func</code> docs of <code><a href="https://callr.r-lib.org/reference/r.html" class="external-link">callr::r()</a></code> for the full set of restrictions on
<code>fn</code>.</p>
<p><code>fn</code> is converted to a function with <code><a href="https://rlang.r-lib.org/reference/as_function.html" class="external-link">rlang::as_function()</a></code>, so it can be
a lambda function.</p></dd>


<dt>...</dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt>args</dt>
<dd><p><code>[list]</code></p>
<p>An optional list of arguments to pass to the function.</p></dd>


<dt>current</dt>
<dd><p><code>[TRUE / FALSE]</code></p>
<p>Should the current git branch be included in the vector of <code>branches</code>?</p></dd>


<dt>branches</dt>
<dd><p><code>[character]</code></p>
<p>A character vector of git branch names to check out, install, and run <code>fn</code>
against.</p>
<p>It is expected that your working directory is set to the git directory
of the package you want to install different branches of. This is typically
the case whenever you open an RStudio project for the package in question.
Technically, the path is determined by <code><a href="https://usethis.r-lib.org/reference/proj_utils.html" class="external-link">usethis::proj_get()</a></code>.</p>
<p>Your git tree must be completely clean to use <code>branches</code>. If there are any
uncommitted changes, an error will be thrown because <code><a href="run.html">run()</a></code> must swap
between the branches to install the package, potentially resulting in a
loss of information. Note that untracked files are not included in this
check - they should never be lost when the branch is changed, but they
could affect the results.</p>
<p>After the last branch is installed, the original branch is checked out.</p></dd>


<dt>libpath</dt>
<dd><p><code>[character]</code></p>
<p>The base library path to use.</p></dd>


<dt>args_pak</dt>
<dd><p><code>[named list]</code></p>
<p>A named list of arguments to pass on to <code><a href="http://pak.r-lib.org/reference/pkg_install.html" class="external-link">pak::pkg_install()</a></code>.</p>
<p>Can't include:</p><ul><li><p><code>pkg</code></p></li>
<li><p><code>lib</code></p></li>
<li><p><code>ask</code></p></li>
</ul></dd>


<dt>args_callr</dt>
<dd><p><code>[named list]</code></p>
<p>A named list of arguments to pass on to <code><a href="https://callr.r-lib.org/reference/r.html" class="external-link">callr::r()</a></code>.</p>
<p>Can't include:</p><ul><li><p><code>func</code></p></li>
<li><p><code>args</code></p></li>
<li><p><code>libpath</code></p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A data frame with two columns:</p><ul><li><p><code>branch</code>, a character vector containing <code>branches</code>.</p></li>
<li><p><code>result</code>, a list column containing the result of calling <code>fn</code> for that
branch of the package.</p></li>
</ul></div>
    <div id="global-options">
    <h2>Global options</h2>
    

<ul><li><p><code>cross.quiet</code>: <code>[TRUE / FALSE]</code></p>
<p>Should cross specific messages about the process be shown?</p>
<p>Defaults to <code>!rlang::is_interactive()</code> if not set, so messages are only
shown when running interactively.</p></li>
<li><p><code>cross.pak_quiet</code>: <code>[TRUE / FALSE]</code></p>
<p>Should pak installation messages be shown?</p>
<p>Defaults to <code>TRUE</code> if not set.</p></li>
</ul></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Similar to `run()`, but this runs the function across 2 local branches.</span></span></span>
<span class="r-in"><span><span class="co"># To run this:</span></span></span>
<span class="r-in"><span><span class="co"># - The working directory is set to the RStudio project for vctrs</span></span></span>
<span class="r-in"><span><span class="co"># - There can't be any uncommitted git changes</span></span></span>
<span class="r-in"><span><span class="co"># - You are currently on a branch, say `fix/performance-bug`</span></span></span>
<span class="r-in"><span><span class="co"># - You'd like to run that branch against `main`</span></span></span>
<span class="r-in"><span><span class="fu">run_branches</span><span class="op">(</span><span class="op">~</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vctrs.r-lib.org/" class="external-link">vctrs</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span><span class="fu"><a href="https://vctrs.r-lib.org/reference/missing.html" class="external-link">vec_detect_missing</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Davis Vaughan, Posit Software, PBC.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

